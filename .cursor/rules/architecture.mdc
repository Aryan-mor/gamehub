# GameHub Architecture Rules

## ğŸ—ï¸ Project Structure & Architecture

### Core Architecture
- **Auto-Discovery Router System**: Use the smart router with auto-discovery for all new routes
- **Hierarchical Routing**: Follow the pattern `games.{game}.{module}.{action}` 
- **Export Default Pattern**: All handlers must use `export default` for auto-discovery
- **Folder Structure**: Each action should be a folder with `index.ts` containing the handler

### Directory Structure
```
src/
â”œâ”€â”€ actions/                # ğŸ¯ Actions & Business Logic
â”‚   â”œâ”€â”€ games/             # Game actions (poker, etc.)
â”‚   â”‚   â”œâ”€â”€ index.ts       # Main games handler
â”‚   â”‚   â””â”€â”€ {game}/        # Individual games
â”‚   â”‚       â”œâ”€â”€ index.ts   # Game-specific handler
â”‚   â”‚       â””â”€â”€ {module}/  # Game modules (room, lobby, etc.)
â”‚   â”‚           â””â”€â”€ {action}/ # Action folders
â”‚   â”‚               â””â”€â”€ index.ts # Action handler (export default)
â”‚   â””â”€â”€ financial/         # Financial actions (wallet, etc.)
â”‚       â””â”€â”€ user-wallet/
â”œâ”€â”€ modules/               # ğŸ”§ Core Modules & Systems
â”‚   â”œâ”€â”€ core/             # Router, handler, utilities
â”‚   â”‚   â”œâ”€â”€ smart-router.ts
â”‚   â”‚   â”œâ”€â”€ handler.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ parseMessageKey.ts
â”‚   â””â”€â”€ global/           # Global configurations
â”œâ”€â”€ utils/                # ğŸ› ï¸ Utilities & Helpers
â”‚   â”œâ”€â”€ types/            # Type definitions
â”‚   â”œâ”€â”€ typeGuards.ts     # ID validation
â”‚   â””â”€â”€ demos/            # Demo files
â”œâ”€â”€ archive/              # ğŸ“¦ Archived/legacy code
â”‚   â””â”€â”€ games/            # Old games
â””â”€â”€ scripts/              # ğŸ”§ Build & deployment scripts
```

## ğŸš€ Development Guidelines

### Router Usage
- Use `smart-router.ts` for all routing
- Register module handlers with `registerModule()`
- Let auto-discovery handle action routes
- Use pattern matching for dynamic routes: `games.:game.room.:action`

### File Naming & Organization
- **Action folders**: Use kebab-case for folder names (`create-room/`, `join-game/`)
- **Handler files**: Always `index.ts` inside action folders
- **Export pattern**: Always `export default` for handlers
- **Import pattern**: Use `@/` alias for imports from src

### Error Handling
- Use proper error types and interfaces
- Implement error boundaries in handlers
- Log errors with context information
- Return user-friendly error messages

### Testing Requirements
- Unit tests for all handlers
- Integration tests for router functionality
- Type checking tests for custom ID types
- Mock external dependencies properly
description:
globs:
alwaysApply: false
---
